0it [00:00, ?it/s]0it [00:00, ?it/s]  0%|          | 0/170498071 [00:01<?, ?it/s]  0%|          | 0/170498071 [00:01<?, ?it/s]  0%|          | 24576/170498071 [00:01<11:43, 242371.67it/s]  0%|          | 24576/170498071 [00:01<11:42, 242595.84it/s]  0%|          | 57344/170498071 [00:01<10:50, 262105.87it/s]  0%|          | 57344/170498071 [00:01<10:50, 262100.42it/s]  0%|          | 106496/170498071 [00:01<09:19, 304748.92it/s]  0%|          | 122880/170498071 [00:01<08:54, 319021.25it/s]  0%|          | 221184/170498071 [00:01<07:16, 390275.88it/s]  0%|          | 221184/170498071 [00:01<07:05, 399956.69it/s]  0%|          | 450560/170498071 [00:01<05:27, 519133.30it/s]  0%|          | 450560/170498071 [00:01<05:20, 531167.56it/s]  1%|          | 909312/170498071 [00:01<03:59, 706858.27it/s]  1%|          | 909312/170498071 [00:01<03:54, 722366.52it/s]  1%|          | 1826816/170498071 [00:02<02:52, 976983.48it/s]  1%|          | 1826816/170498071 [00:02<02:49, 997681.43it/s]  2%|▏         | 3678208/170498071 [00:02<02:02, 1364397.29it/s]  2%|▏         | 3678208/170498071 [00:02<01:59, 1392527.04it/s]  4%|▍         | 6512640/170498071 [00:02<01:25, 1908712.15it/s]  4%|▍         | 6463488/170498071 [00:02<01:24, 1946016.71it/s]  6%|▌         | 9641984/170498071 [00:02<01:00, 2656299.50it/s]  6%|▌         | 9592832/170498071 [00:02<00:59, 2701959.03it/s]  8%|▊         | 12787712/170498071 [00:02<00:43, 3658701.86it/s]  7%|▋         | 12722176/170498071 [00:02<00:42, 3712568.50it/s]  9%|▉         | 15900672/170498071 [00:02<00:31, 4975074.94it/s]  9%|▉         | 15835136/170498071 [00:02<00:30, 5026438.72it/s] 11%|█         | 19013632/170498071 [00:02<00:22, 6639975.83it/s] 11%|█         | 18964480/170498071 [00:02<00:22, 6711882.71it/s] 13%|█▎        | 22126592/170498071 [00:02<00:17, 8679164.34it/s] 13%|█▎        | 22093824/170498071 [00:02<00:16, 8769198.27it/s] 15%|█▍        | 25223168/170498071 [00:02<00:13, 11052273.92it/s] 15%|█▍        | 25223168/170498071 [00:02<00:13, 11165699.34it/s] 17%|█▋        | 28319744/170498071 [00:02<00:10, 13664731.64it/s] 17%|█▋        | 28336128/170498071 [00:02<00:10, 13797415.58it/s] 18%|█▊        | 31432704/170498071 [00:03<00:08, 16393084.48it/s] 18%|█▊        | 31399936/170498071 [00:03<00:08, 16482896.27it/s] 20%|██        | 34512896/170498071 [00:03<00:07, 19019689.72it/s] 20%|██        | 34480128/170498071 [00:03<00:07, 19100401.30it/s] 22%|██▏       | 37593088/170498071 [00:03<00:06, 21420645.51it/s] 22%|██▏       | 37543936/170498071 [00:03<00:06, 21461714.03it/s] 24%|██▍       | 40722432/170498071 [00:03<00:05, 23575147.19it/s] 24%|██▍       | 40607744/170498071 [00:03<00:05, 23507745.02it/s] 26%|██▌       | 43753472/170498071 [00:03<00:05, 25201740.08it/s] 26%|██▌       | 43671552/170498071 [00:03<00:05, 25172443.23it/s] 27%|██▋       | 46776320/170498071 [00:03<00:04, 26191832.93it/s] 27%|██▋       | 46751744/170498071 [00:03<00:04, 26535023.09it/s] 29%|██▉       | 49758208/170498071 [00:03<00:04, 26735254.50it/s] 29%|██▉       | 49831936/170498071 [00:03<00:04, 27582510.96it/s] 31%|███       | 52813824/170498071 [00:03<00:04, 27688297.98it/s] 31%|███       | 52854784/170498071 [00:03<00:04, 27989933.15it/s] 33%|███▎      | 55926784/170498071 [00:03<00:04, 28527502.77it/s] 33%|███▎      | 55844864/170498071 [00:03<00:04, 28463802.62it/s] 35%|███▍      | 58916864/170498071 [00:04<00:03, 28713284.82it/s] 35%|███▍      | 58859520/170498071 [00:04<00:03, 28938459.69it/s] 36%|███▋      | 61890560/170498071 [00:04<00:03, 28703665.84it/s] 36%|███▋      | 61956096/170498071 [00:04<00:03, 29404431.58it/s] 38%|███▊      | 64831488/170498071 [00:04<00:03, 28629679.62it/s] 38%|███▊      | 65036288/170498071 [00:04<00:03, 29682794.97it/s] 40%|███▉      | 67747840/170498071 [00:04<00:03, 28686487.07it/s] 40%|███▉      | 68165632/170498071 [00:04<00:03, 29952608.40it/s] 41%|████▏     | 70656000/170498071 [00:04<00:03, 28770389.70it/s] 42%|████▏     | 71262208/170498071 [00:04<00:03, 30111493.47it/s] 43%|████▎     | 73564160/170498071 [00:04<00:03, 28862731.54it/s] 44%|████▎     | 74301440/170498071 [00:04<00:03, 30108167.22it/s] 45%|████▍     | 76472320/170498071 [00:04<00:03, 28669491.74it/s] 45%|████▌     | 77332480/170498071 [00:04<00:03, 29693108.25it/s] 47%|████▋     | 79355904/170498071 [00:04<00:03, 28469507.62it/s] 47%|████▋     | 80322560/170498071 [00:04<00:03, 29344243.79it/s] 48%|████▊     | 82403328/170498071 [00:04<00:03, 28965088.02it/s] 49%|████▉     | 83271680/170498071 [00:04<00:02, 29268939.83it/s] 50%|█████     | 85516288/170498071 [00:04<00:02, 29450076.81it/s] 51%|█████     | 86319104/170498071 [00:04<00:02, 29569774.12it/s] 52%|█████▏    | 88580096/170498071 [00:05<00:02, 29699805.05it/s] 52%|█████▏    | 89448448/170498071 [00:05<00:02, 29917264.76it/s] 54%|█████▍    | 91709440/170498071 [00:05<00:02, 30014477.60it/s] 54%|█████▍    | 92528640/170498071 [00:05<00:02, 30042385.03it/s] 56%|█████▌    | 94773248/170498071 [00:05<00:02, 30163499.46it/s] 56%|█████▌    | 95625216/170498071 [00:05<00:02, 30182459.40it/s] 57%|█████▋    | 97796096/170498071 [00:05<00:02, 29682786.69it/s] 58%|█████▊    | 98689024/170498071 [00:05<00:02, 30194755.31it/s] 59%|█████▉    | 100769792/170498071 [00:05<00:02, 29327976.65it/s] 60%|█████▉    | 101801984/170498071 [00:05<00:02, 30335155.55it/s] 61%|██████    | 103710720/170498071 [00:05<00:02, 28989569.60it/s] 62%|██████▏   | 104914944/170498071 [00:05<00:02, 30355780.88it/s] 63%|██████▎   | 106766336/170498071 [00:05<00:02, 29266441.29it/s] 63%|██████▎   | 107954176/170498071 [00:05<00:02, 30283894.58it/s] 64%|██████▍   | 109895680/170498071 [00:05<00:02, 29711885.24it/s] 65%|██████▌   | 110985216/170498071 [00:05<00:01, 29772067.95it/s] 66%|██████▋   | 112975872/170498071 [00:05<00:01, 29904945.12it/s] 67%|██████▋   | 113967104/170498071 [00:05<00:01, 29297711.67it/s] 68%|██████▊   | 116056064/170498071 [00:05<00:01, 30034442.01it/s] 69%|██████▊   | 116908032/170498071 [00:05<00:01, 29015247.72it/s] 70%|██████▉   | 119169024/170498071 [00:06<00:01, 30209817.20it/s] 70%|███████   | 119906304/170498071 [00:06<00:01, 29241303.92it/s] 72%|███████▏  | 122281984/170498071 [00:06<00:01, 30350641.65it/s] 72%|███████▏  | 123019264/170498071 [00:06<00:01, 29676641.49it/s] 74%|███████▎  | 125378560/170498071 [00:06<00:01, 29929470.78it/s] 74%|███████▍  | 126115840/170498071 [00:06<00:01, 29917236.48it/s] 75%|███████▌  | 128491520/170498071 [00:06<00:01, 30139156.12it/s] 76%|███████▌  | 129228800/170498071 [00:06<00:01, 30149025.99it/s] 77%|███████▋  | 131588096/170498071 [00:06<00:01, 30247026.17it/s] 78%|███████▊  | 132358144/170498071 [00:06<00:01, 30361413.21it/s] 79%|███████▉  | 134668288/170498071 [00:06<00:01, 30282930.05it/s] 79%|███████▉  | 135438336/170498071 [00:06<00:01, 30340809.74it/s] 81%|████████  | 137699328/170498071 [00:06<00:01, 29916160.92it/s] 81%|████████▏ | 138567680/170498071 [00:06<00:01, 30497538.72it/s] 83%|████████▎ | 140697600/170498071 [00:06<00:01, 29632853.02it/s] 83%|████████▎ | 141631488/170498071 [00:06<00:00, 30470188.09it/s] 84%|████████▍ | 143679488/170498071 [00:06<00:00, 29649511.92it/s] 85%|████████▍ | 144687104/170498071 [00:06<00:00, 30180359.11it/s] 86%|████████▌ | 146710528/170498071 [00:06<00:00, 29840957.84it/s] 87%|████████▋ | 147709952/170498071 [00:06<00:00, 29745396.25it/s] 88%|████████▊ | 149708800/170498071 [00:07<00:00, 29792622.23it/s] 88%|████████▊ | 150691840/170498071 [00:07<00:00, 29314296.90it/s] 90%|████████▉ | 152739840/170498071 [00:07<00:00, 29942394.19it/s] 90%|█████████ | 153673728/170498071 [00:07<00:00, 29408280.70it/s] 91%|█████████▏| 155803648/170498071 [00:07<00:00, 30071660.06it/s] 92%|█████████▏| 156803072/170498071 [00:07<00:00, 29787199.99it/s] 93%|█████████▎| 158916608/170498071 [00:07<00:00, 30239274.51it/s] 94%|█████████▍| 159916032/170498071 [00:07<00:00, 30021137.71it/s] 95%|█████████▍| 161947648/170498071 [00:07<00:00, 30174763.22it/s] 96%|█████████▌| 162996224/170498071 [00:07<00:00, 30113861.03it/s] 97%|█████████▋| 164970496/170498071 [00:07<00:00, 29715096.06it/s] 97%|█████████▋| 166092800/170498071 [00:07<00:00, 30225959.10it/s] 99%|█████████▊| 167944192/170498071 [00:07<00:00, 29355913.18it/s] 99%|█████████▉| 169172992/170498071 [00:07<00:00, 30238666.29it/s]170500096it [00:11, 15499112.79it/s]                               
170500096it [00:11, 15452566.22it/s]                               
Traceback (most recent call last):
Traceback (most recent call last):
  File "rocl_train.py", line 89, in <module>
  File "rocl_train.py", line 89, in <module>
    model       = torch.nn.parallel.DistributedDataParallel(
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 446, in __init__
    model       = torch.nn.parallel.DistributedDataParallel(
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 446, in __init__
    self._sync_params_and_buffers(authoritative_rank=0)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 457, in _sync_params_and_buffers
    self._sync_params_and_buffers(authoritative_rank=0)
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 457, in _sync_params_and_buffers
    self._distributed_broadcast_coalesced(
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1155, in _distributed_broadcast_coalesced
    self._distributed_broadcast_coalesced(
  File "/opt/conda/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1155, in _distributed_broadcast_coalesced
    dist._broadcast_coalesced(
RuntimeError: NCCL error in: /opt/conda/conda-bld/pytorch_1616554793803/work/torch/lib/c10d/ProcessGroupNCCL.cpp:825, invalid usage, NCCL version 2.7.8
ncclInvalidUsage: This usually reflects invalid usage of NCCL library (such as too many async ops, too many collectives at once, mixing streams in a group, etc).
    dist._broadcast_coalesced(
RuntimeError: NCCL error in: /opt/conda/conda-bld/pytorch_1616554793803/work/torch/lib/c10d/ProcessGroupNCCL.cpp:825, invalid usage, NCCL version 2.7.8
ncclInvalidUsage: This usually reflects invalid usage of NCCL library (such as too many async ops, too many collectives at once, mixing streams in a group, etc).
Traceback (most recent call last):
  File "/opt/conda/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/opt/conda/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/opt/conda/lib/python3.8/site-packages/torch/distributed/launch.py", line 340, in <module>
    main()
  File "/opt/conda/lib/python3.8/site-packages/torch/distributed/launch.py", line 326, in main
    sigkill_handler(signal.SIGTERM, None)  # not coming back
  File "/opt/conda/lib/python3.8/site-packages/torch/distributed/launch.py", line 301, in sigkill_handler
    raise subprocess.CalledProcessError(returncode=last_return_code, cmd=cmd)
subprocess.CalledProcessError: Command '['/opt/conda/bin/python', '-u', 'rocl_train.py', '--local_rank=1', '--ngpu', '2', '--batch-size=256', '--model=ResNet18', '--k=7', '--loss_type=sim', '--advtrain_type=Rep', '--attack_type=linf', '--regularize_to=other', '--attack_to=other', '--train_type=contrastive', '--dataset=cifar-10']' returned non-zero exit status 1.
